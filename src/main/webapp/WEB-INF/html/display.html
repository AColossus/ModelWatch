<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>模型展览</title>
    <link rel="stylesheet" type="text/css" href="../../resources/css/main.css" />
    <link rel="stylesheet" type="text/css" href="../../resources/css/watchUI.css" />
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="../resources/js/three.min.js"></script>
    <!-- 引入样式 -->
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <!-- 引入组件库 -->
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
</head>

<body>
    <div id="nav" @mouseenter="isActive=true" @mouseleave="isActive=false">
        <div style="z-index: 10000" class="nav-wrapper moveable" :class={active:isActive}>
            <mw-nav :user="user" :cs="cs"></mw-nav>
        </div>
        <div style="height: 60px;opacity:0;position:absolute;width: 100%;"></div>
    </div>
    <div id="view" :style="{width:width+'px',height:height+'px'}" style="overflow: hidden">
        <div class="leftbar moveable" :style="{transform:transform}">
            <!-- <div  class="leftbar moveable" > -->
            <el-tree :data="components" :props="defaultProps" ></el-tree>
        </div>
        <article id="3dcanvas" style="background: rgb(231, 231, 231);" onmousewheel="mousescale(event)" onmousedown="pushControl(event)"
            onmouseup="upControl(event)" onmouseleave="moveclean()" @click="cast">
        </article>

        <!-- <div class="rightbar" :style="{opacity:opacity}" @mouseover="opacity=1" @mouseleave="opacity=0" > -->
        <div class="rightbar" style="opacity: 1">
            <a title="切换模式" href="editor.html">
                <div class="mw-icon transbutton"></div>
            </a>
            <div title="收藏">
                <div class="mw-icon lovebutton"></div>
            </div>
            <div title="下载">
                <div class="mw-icon downloadbutton"></div>
            </div>
        </div>
    </div>
</body>
<!-- 顶点着色器 -->
<script type="x-shader/x-vertex" id="vertexshader">
    varying vec3 fragNormal;
    varying vec3 rimNormal;
    uniform vec3 directLight;
    
        void main() {
            fragNormal=normalize(normalMatrix*normal);
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
            vec3 viewNormal=normalize(cameraPosition);
            rimNormal=normal;
        }
</script>

<!--片元着色器程序-->
<script type="x-shader/x-fragment" id="fragmentshader">
    uniform vec3 directLight;
    uniform vec4 color;
    uniform mat3 normalMatrix;
    varying vec3 rimNormal;

    varying vec3 fragNormal;
    void main()
    {
        vec3 normalDLight=normalize(normalMatrix*directLight);

        float diffuseStrength=dot(normalDLight,fragNormal);
        diffuseStrength=clamp(diffuseStrength,0.0,1.0);

        vec3 ambient=vec3(0.1);
        vec4 finalLightStrength=vec4(ambient+diffuseStrength,1.0);

        vec3 cnorml=normalize(cameraPosition);
        float rim=1.0-max(dot(rimNormal,cnorml),0.0);
        vec4 rimColor=vec4(vec3(0.9,0.9,0.0)*pow(rim,1.4),1.0);
        

        
        gl_FragColor=finalLightStrength*color+rimColor;
    }
</script>
<script src="../../resources/js/watchUI.js"></script>
<script src="../../resources/js/modelControl.js"></script>
<script src="../../resources/js/display.js"></script>


</html>